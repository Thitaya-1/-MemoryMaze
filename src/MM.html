<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Memory Maze</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  font-family:'Segoe UI',sans-serif;
  overflow:hidden;
  background: transparent; /* ‡∏™‡∏µ‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏¢‡∏≤‡∏°‡∏Ñ‡πà‡∏≥‡∏Ñ‡∏∑‡∏ô */
}
#bgFantasy {
  position: fixed;
  inset: 0;
  z-index: -1;

  /* üåå ‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏¢‡∏≤‡∏°‡∏Ñ‡πà‡∏≥‡∏Ñ‡∏∑‡∏ô + ‡πÅ‡∏™‡∏á/‡πÄ‡∏°‡∏Ü */
  background:
    radial-gradient(circle at 20% 30%, #a0c4ff55, transparent 40%),  /* ‡πÅ‡∏™‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
    radial-gradient(circle at 80% 60%, #bdb2ff55, transparent 50%),  /* ‡∏´‡∏°‡∏≠‡∏Å/‡πÄ‡∏°‡∏Ü‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ */
    linear-gradient(180deg, #0b0d2b, #1a1f44, #3e4a73);             /* ‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° */

  background-size: 200% 200%;
  animation: fantasyMove 40s ease-in-out infinite alternate;
}

@keyframes fantasyMove {
  0%   { background-position: 0% 0%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 0%; }
}
/* ‡∏™‡∏£‡πâ‡∏≤‡∏á glow ‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏ö‡∏ô particles */
.star {
  position: absolute;
  width: 2px;
  height: 2px;
  border-radius: 50%;
  background: #fff8;
  box-shadow: 0 0 4px #fff8;
}


#gameWrap{
  position:relative;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1;
}

/* üß© ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÄ‡∏Å‡∏° */
canvas{
  background:transparent;
  border-radius:32px;
  animation: softPulse 6s ease-in-out infinite;
}
@keyframes softPulse {
  0% {
    box-shadow:
      0 30px 60px rgba(236,72,153,.25),
      inset 0 0 0 6px #ffffffaa;
  }
  50% {
    box-shadow:
      0 36px 70px rgba(236,72,153,.35),
      inset 0 0 0 6px #ffffffaa;
  }
  100% {
    box-shadow:
      0 30px 60px rgba(236,72,153,.25),
      inset 0 0 0 6px #ffffffaa;
  }
}

#particles{
  position:fixed;
  inset:0;
  z-index:0;
  pointer-events:none;
}

/* üß† HUD ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
#hud{
  position:absolute;
  top:24px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:14px;
  font-size:17px;
  color:#7a284e;
  user-select:none;
  pointer-events:auto;
}
@keyframes hudGlow {
  0% { box-shadow:0 10px 30px rgba(0,0,0,.15); }
  50% { box-shadow:0 14px 36px rgba(236,72,153,.35); }
  100% { box-shadow:0 10px 30px rgba(0,0,0,.15); }
}

/* üè∑Ô∏è ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
.hudBox{
  background:linear-gradient(135deg,#ffffffdd,#ffe4f1dd);
  padding:10px 20px;
  border-radius:999px;
  min-width:90px;
  text-align:center;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  backdrop-filter:blur(6px);
  animation: hudGlow 5s ease-in-out infinite;
}

/* üå∏ overlay (start / game over) */
/* overlay ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° / ‡∏à‡∏ö‡πÄ‡∏Å‡∏° */
#overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(11, 12, 42, 0.85); /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô bg */
  backdrop-filter: blur(6px);
  z-index: 2;
}

/* panel ‡∏Å‡∏•‡πà‡∏≠‡∏á start / game over */
.panel {
  background: linear-gradient(145deg, #1a1f44, #3e4a73); /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤ */
  padding: 44px 50px;
  border-radius: 36px;
  text-align: center;
  max-width: 420px;
  box-shadow: 0 40px 90px rgba(236, 72, 153, 0.35);
  animation: panelPop 0.5s ease;
}

/* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏´‡πâ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
.panel h1 {
  margin-top: 0;
  font-size: 32px;
  color: #f9a8d4; /* ‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π‡∏≠‡πà‡∏≠‡∏ô */
}

.panel p {
  color: #e0d7ff; /* ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á‡∏≠‡πà‡∏≠‡∏ô / ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
  line-height: 1.7;
  font-size: 16px;
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
button {
  margin-top: 26px;
  padding: 14px 42px;
  border: none;
  border-radius: 999px;
  font-size: 18px;
  cursor: pointer;
  background: linear-gradient(135deg, #f9a8d4, #ec4899);
  color: #fff;
  box-shadow: 0 10px 30px rgba(236, 72, 153, 0.45);
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

button:hover{
  transform:translateY(-2px);
  box-shadow:0 16px 40px rgba(236,72,153,.55);
}

button:active{
  transform:scale(.96);
}

.heart{
  font-size:22px;
  color:#ef4444;
  animation:pulse 1.2s infinite;
}
@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.15)}
  100%{transform:scale(1)}
}

</style>
</head>
<body>
<div id="bgFantasy"></div>
<canvas id="particles"></canvas>
<div id="gameWrap">
<canvas id="maze"></canvas>
<div id="hud">
<div class="hudBox">
<label style="cursor:pointer;font-size:14px">üì∑ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£
<input type="file" id="playerUpload" accept="image/png,image/jpeg" style="display:none"></label>
</div>
<div class="hudBox">Level <span id="level">1</span></div>
<div class="hudBox">Score <span id="score">0</span></div>
<div class="hudBox" id="lives"></div>
<div class="hudBox">Time <span id="timer">7</span></div>
</div>
<div id="overlay">
<div class="panel" id="startPanel">
<h1>Memory Maze</h1>
<p> 1.‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏î‡∏à‡∏≥‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î <br>
2.‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏®‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ <br>
3.‡∏´‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏•‡∏î‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏•‡∏á <br>
4.‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‡∏à‡∏∞‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <br>
!!  ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏à‡∏ô‡∏´‡∏°‡∏î Game Over !! <br>
‡∏õ‡∏•.‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á
</p>
<button id="startBtn">Start Game</button>
</div>
<div class="panel" id="gameOverPanel" style="display:none">
<h1>Game Over</h1>
<p id="finalScore"></p>
<button id="restartBtn">Restart</button>
</div>
</div>
</div>

<audio id="bgm" loop src="bgm.mp3"></audio>
<audio id="stepSnd" src="step.mp3"></audio>
<audio id="hitSnd" src="hit.mp3"></audio>
<audio id="gameOverSnd" src="gameover.mp3"></audio>
<audio id="winSnd" src="win.mp3"></audio>


<script>
const canvas=document.getElementById('maze'),ctx=canvas.getContext('2d')
const overlay=document.getElementById('overlay')
const startPanel=document.getElementById('startPanel')
const gameOverPanel=document.getElementById('gameOverPanel')
const levelEl=document.getElementById('level')
const scoreEl=document.getElementById('score')
const timerEl=document.getElementById('timer')
const livesEl=document.getElementById('lives')
const bgm=document.getElementById('bgm')
const stepSnd=document.getElementById('stepSnd')
const hitSnd=document.getElementById('hitSnd')
const gameOverSnd=document.getElementById('gameOverSnd')
const winSnd = document.getElementById('winSnd')
const particlesCanvas = document.getElementById('particles');
const pCtx = particlesCanvas.getContext('2d');

function resizeParticles(){
  particlesCanvas.width = window.innerWidth;
  particlesCanvas.height = window.innerHeight;
}
resizeParticles();
window.addEventListener('resize', resizeParticles);

const particleCount = 80;
const particles = [];

// ‡∏™‡∏£‡πâ‡∏≤‡∏á particles
for(let i=0;i<particleCount;i++){
  particles.push({
    x: Math.random()*particlesCanvas.width,
    y: Math.random()*particlesCanvas.height,
    r: Math.random()*2 + 1,
    alpha: Math.random()*0.5 + 0.3,
    speed: Math.random()*0.3 + 0.1,
    angle: Math.random()*Math.PI*2,
    twinkleSpeed: Math.random()*0.05 + 0.02 // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ß‡∏π‡∏ö‡∏ß‡∏≤‡∏ö
  });
}

// ‡∏ß‡∏≤‡∏î particles
function drawParticles(){
  pCtx.clearRect(0,0,particlesCanvas.width,particlesCanvas.height);
  for(const p of particles){
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏π‡∏ö‡∏ß‡∏≤‡∏ö
    const glow = 0.5 + 0.5*Math.sin(Date.now()/500 + p.twinkleSpeed*100);
    pCtx.globalAlpha = glow;
    pCtx.fillStyle = '#f9a8d4'; // ‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π‡∏´‡∏¥‡πà‡∏á‡∏´‡πâ‡∏≠‡∏¢
    pCtx.beginPath();
    pCtx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    pCtx.fill();

    // ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏•‡∏≠‡∏¢‡πÄ‡∏ö‡∏≤
    p.x += Math.cos(p.angle)*p.speed;
    p.y += Math.sin(p.angle)*p.speed;

    // ‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    if(p.x<0)p.x=particlesCanvas.width;
    if(p.x>particlesCanvas.width)p.x=0;
    if(p.y<0)p.y=particlesCanvas.height;
    if(p.y>particlesCanvas.height)p.y=0;
  }
  requestAnimationFrame(drawParticles);
}
drawParticles();
for(let i=0;i<100;i++){
  const star = document.createElement('div');
  star.className = 'star';
  star.style.left = Math.random() * window.innerWidth + 'px';
  star.style.top = Math.random() * window.innerHeight + 'px';
  star.style.width = (Math.random() * 2 + 1) + 'px';
  star.style.height = star.style.width;
  document.body.appendChild(star);
}

let level=1,score=0,lives=3,gridSize=6,memorizeTime=7
let maze=[],player=null,goal=null,showMaze=false,playing=false,timerInt=null
const CELL=80

function resize(){canvas.width=gridSize*CELL;canvas.height=gridSize*CELL}

function generateMaze(n){
 const g=Array.from({length:n},()=>Array.from({length:n},()=>({v:false,w:{t:1,r:1,b:1,l:1}})))
 function shuffle(a){return a.sort(()=>Math.random()-.5)}
 function carve(x,y){
  g[y][x].v=true
  for(const[dX,dY,w,o] of shuffle([[0,-1,'t','b'],[1,0,'r','l'],[0,1,'b','t'],[-1,0,'l','r']])){
   const nx=x+dX,ny=y+dY
   if(nx>=0&&ny>=0&&nx<n&&ny<n&&!g[ny][nx].v){
    g[y][x].w[w]=0;g[ny][nx].w[o]=0;carve(nx,ny)
   }
  }
 }
 carve(0,0);return g
}

function line(x1,y1,x2,y2){ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke()}

let playerImg=null,playerImgReady=false
function drawPlayer(){
 if(!player)return
 if(playerImg&&playerImgReady){
  ctx.drawImage(playerImg,player.x*CELL+CELL*0.15,player.y*CELL+CELL*0.15,CELL*0.7,CELL*0.7)
 }else{
  ctx.fillStyle='#f472b6'
  ctx.beginPath()
  ctx.arc(player.x*CELL+CELL/2,player.y*CELL+CELL/2,CELL*0.3,0,Math.PI*2)
  ctx.fill()
 }
}

function circle(x,y,r){ctx.beginPath();ctx.arc(x*CELL+CELL/2,y*CELL+CELL/2,CELL*r,0,Math.PI*2);ctx.fill()}
function drawGoalFlag(){
  if(!goal || !player) return

  // ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ö‡∏ò‡∏á
  const dx = player.x - goal.x
  const dy = player.y - goal.y
  const dist = Math.sqrt(dx*dx + dy*dy)

  // ‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡πÅ‡∏™‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ
  const glow = dist <= 1.5
  ctx.save()

  if(glow){
    ctx.shadowColor = '#34d399'
    ctx.shadowBlur = 20
  }

  const cx = goal.x * CELL + CELL/2
  const cy = goal.y * CELL + CELL/2

  // üå¨Ô∏è ‡∏ò‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏¥‡∏Å
  const wave = Math.sin(Date.now() / 250) * 6

  // ‡πÄ‡∏™‡∏≤‡∏ò‡∏á
  ctx.strokeStyle = '#065f46'
  ctx.lineWidth = 4
  ctx.beginPath()
  ctx.moveTo(cx, cy - 22)
  ctx.lineTo(cx, cy + 18)
  ctx.stroke()

  // ‡∏ú‡∏∑‡∏ô‡∏ò‡∏á
  ctx.fillStyle = '#34d399'
  ctx.beginPath()
  ctx.moveTo(cx, cy - 22)
  ctx.quadraticCurveTo(
    cx + 22 + wave,
    cy - 10,
    cx,
    cy
  )
  ctx.closePath()
  ctx.fill()

  ctx.restore()
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height)
 if(maze.length&&player&&goal){
  for(let y=0;y<gridSize;y++)for(let x=0;x<gridSize;x++){
   const c=maze[y][x],px=x*CELL,py=y*CELL
   if(showMaze){
    ctx.strokeStyle='#f472b6';ctx.lineWidth=4
    if(c.w.t)line(px,py,px+CELL,py)
    if(c.w.r)line(px+CELL,py,px+CELL,py+CELL)
    if(c.w.b)line(px,py+CELL,px+CELL,py+CELL)
    if(c.w.l)line(px,py,px,py+CELL)
   }
  }
  drawGoalFlag(goal.x, goal.y)
  drawPlayer()
 }
 requestAnimationFrame(draw)
}

function updateLives(){livesEl.innerHTML='';for(let i=0;i<lives;i++)livesEl.innerHTML+='<span class="heart">‚ù§</span>'}

function startLevel(){
 maze=generateMaze(gridSize)
 player={x:0,y:0}
 goal={x:gridSize-1,y:gridSize-1}
 resize();showMaze=true;playing=false
 let t=memorizeTime;timerEl.textContent=t
 clearInterval(timerInt)
 timerInt=setInterval(()=>{
  t--;timerEl.textContent=t
  if(t<=0){clearInterval(timerInt);showMaze=false;playing=true;bgm.play().catch(()=>{})}
 },1000)
}

// ‡πÄ‡∏Å‡πá‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏î‡∏¥‡∏ô
let visited = new Set();

function move(dx, dy){
  if(!playing || !player || !goal) return;
  const c = maze[player.y][player.x];

  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á
  if((dx==0&&dy==-1&&c.w.t)||(dx==1&&dy==0&&c.w.r)||(dx==0&&dy==1&&c.w.b)||(dx==-1&&dy==0&&c.w.l)){
    hitSnd.currentTime=0; hitSnd.play();
    lives--;
    updateLives();

    score = Math.max(0, score - 5);
    scoreEl.textContent = score;

    if(lives<=0) return gameOver();
    return;
  }

  // ‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏î‡πâ
  stepSnd.currentTime=0; stepSnd.play();
  player.x += dx;
  player.y += dy;

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á key ‡∏û‡∏¥‡∏Å‡∏±‡∏î
  const key = `${player.x},${player.y}`;

  // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  if(!visited.has(key)){
    score += 10;
    scoreEl.textContent = score;
    visited.add(key);
  }

  // ‡∏ñ‡∏∂‡∏á goal
  if(player.x===goal.x && player.y===goal.y){
    winSnd.currentTime = 0;
    winSnd.play().catch(()=>{});

    score += 100; // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô
    level++;
    gridSize++;
    memorizeTime = Math.max(3, memorizeTime - 1);

    lives = 3;
    updateLives();
    levelEl.textContent = level;
    scoreEl.textContent = score;

    startLevel();
  }
}

function startGame(){
level=1;score=0;lives=3;gridSize=6;memorizeTime=7
levelEl.textContent=1;scoreEl.textContent=0
updateLives()
overlay.style.display='none'
startPanel.style.display='block'
gameOverPanel.style.display='none'


// üîä IMPORTANT: unlock audio by user gesture
bgm.currentTime = 0
bgm.volume = 0.5
bgm.play().catch(()=>{})


startLevel()
}

function gameOver(){
 playing=false;bgm.pause();gameOverSnd.currentTime=0;gameOverSnd.play()
 overlay.style.display='flex'
 startPanel.style.display='none'
 gameOverPanel.style.display='block'
 document.getElementById('finalScore').textContent='Score: '+score
}

addEventListener('keydown',e=>{
 if(e.key==='ArrowUp')move(0,-1)
 if(e.key==='ArrowDown')move(0,1)
 if(e.key==='ArrowLeft')move(-1,0)
 if(e.key==='ArrowRight')move(1,0)
})

document.getElementById('startBtn').onclick=startGame
document.getElementById('restartBtn').onclick=()=>location.reload()
document.getElementById('playerUpload').addEventListener('change',e=>{
 const f=e.target.files[0]
 if(!f)return
 const img=new Image()
 img.onload=()=>{playerImg=img;playerImgReady=true}
 img.onerror=()=>{playerImg=null;playerImgReady=false}
 img.src=URL.createObjectURL(f)
})
updateLives();draw()
</script>
</body>

</html> 
